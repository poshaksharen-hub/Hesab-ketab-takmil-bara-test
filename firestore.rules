
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    
    // Helper function to check if the user is one of the two family members.
    function isFamilyMember() {
      // The UIDs for Ali and Fatemeh.
      let familyUIDs = [
          "gHZ9n7s2b9X8fJ2kP3s5t8YxVOE2", // Ali's UID
          "iwXrEC4MPze90eK0BExOdqMdTZ43"  // Fatemeh's UID
      ];
      return request.auth != null && request.auth.uid in familyUIDs;
    }
    
    // Grant full read/write access to all collections and documents
    // for any authenticated family member.
    // This single rule covers /users/{userId}, all its subcollections,
    // and the /shared path.
    match /{path=**} {
      allow read, write: if isFamilyMember();
    }
  }
}
